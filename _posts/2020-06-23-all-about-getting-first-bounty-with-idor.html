---
layout: post
title: All About Getting First Bounty with IDOR
date: 2020-06-23
categories: [Bounty, Security]
tags: [idor, bug bounty]
---

<p>All About Getting First Bounty with IDOR</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*dRXDr2qaU_FOtcUzhV1_bA.png" /></figure><p>Hello All,</p><p>In April ’20, I started reading and practising about IDOR, for the first few days it was looking hard to find IDOR vulnerability. So I went back to different practise labs to get a wider Idea about this vulnerability and various ways to exploit this vulnerability. I have practised on <a href="https://www.dvwa.co.uk/">DVWA</a>, <a href="https://www.itsecgames.com/">bWAPP</a>, and <a href="https://portswigger.net/web-security/access-control/idor">Portswigger Academy</a>.</p><p>According to <a href="https://owasp.org/">OWASP </a>:</p><blockquote>“ <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References">Insecure Direct Object References</a> occur when an application provides direct access to objects based on user-supplied input. As a result of this vulnerability attackers can bypass authorization and access resources in the system directly, for example database records or files. Insecure Direct Object References allow attackers to bypass authorization and access resources directly by modifying the value of a parameter used to directly point to an object. Such resources can be database entries belonging to other users, files in the system, and more.”</blockquote><p>Writeups and Mindmap which I followed are shared at the end of this writeup.</p><p>In this writeup I am sharing few of the scenarios which I reported to a Program. Lets say, I have created 3 users on a website which are User_1, User_2 and User_3 with the same role and permission :</p><p><strong>Scenario #1</strong> : There was a functionality, when a user creates a post and someone can like, comment and share that post on their profile. But while checking this functionality I noticed that the other user can only mention the author of that post in the comment and the mentioned person receives the notification of the same.</p><p>Detailed attack scenario :</p><ol><li>User_1 created a post.</li><li>Now when User_2 comments on that post, I noticed that I can mention only author of that post which in this case is User_1.</li><li>So, captured the comment (comment is : Please check @User_1) request in Burp and JSON data was passing like this:</li><li>{“text”:”Please check @[User_1 name]”,”mentions”:[{“uid”:”random 9 digits&quot;,”key”:”User_1 name&quot;}],”message_id”:random 9 digits}</li><li>in the above JSON data, the uid is of User_1 and By visiting the profile of User_3 and by doing “inspect element” on the profile picture of User_3, I can get the uid of user_3.</li><li>So in the JSON data, changed User_1 name to User_3 name in the both values and replaced uid of User_1 to uid of User_3.</li><li>Finally I was able to mention any other user in that post and the mentioned user gets notification of it.</li></ol><p>Program rewarded me $$$ for this bug and this was my first ever bounty :D</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fgiphy.com%2Fembed%2FVbEC9WchxkiWTL5PFo%2Ftwitter%2Fiframe&amp;display_name=Giphy&amp;url=https%3A%2F%2Fgiphy.com%2Fgifs%2Falternatino-no-crying-happy-tears-VbEC9WchxkiWTL5PFo&amp;image=https%3A%2F%2Fmedia1.giphy.com%2Fmedia%2FVbEC9WchxkiWTL5PFo%2Fgiphy.gif&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=giphy" width="435" height="244" frameborder="0" scrolling="no"><a href="https://medium.com/media/85ec7de122bf45eebaf11f3405ea8976/href">https://medium.com/media/85ec7de122bf45eebaf11f3405ea8976/href</a></iframe><p><strong>Scenario #2</strong> : There was a functionality to either Join a group or Create a group, after creating a group the user gets a group_code which he can share with other users and that referred user will get add in the group without approval of owner of the group.</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fgiphy.com%2Fembed%2FxULW8mDddvBIh8EQPS%2Ftwitter%2Fiframe&amp;display_name=Giphy&amp;url=https%3A%2F%2Fgiphy.com%2Fgifs%2Fnotsofastmedia-reaction-wow-xULW8mDddvBIh8EQPS&amp;image=https%3A%2F%2Fmedia3.giphy.com%2Fmedia%2FxULW8mDddvBIh8EQPS%2Fgiphy.gif&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=giphy" width="435" height="435" frameborder="0" scrolling="no"><a href="https://medium.com/media/bbd6b9bccc95ead72f134bceac12b617/href">https://medium.com/media/bbd6b9bccc95ead72f134bceac12b617/href</a></iframe><p>Detailed attack scenario :</p><ol><li>User_1 selects on “Create a group” and after giving a name and adding discription to the group, User_1 gets a refer_code (random 6 words eg. pgytsd) for the group.</li><li>Now User_2 selects to “Join a group” and enters pgytsd in the code and I captured this request.</li><li>So, in “Join a group” request the JSON data was passing like below :</li><li>{“membership”:{“access_code”:”pgytsd”}}</li><li>I just needed to change or bruteforce on the access_code</li><li>After changing the group code I was getting added into Any users group and also in the Burp response, User_2 was able to see the name and description of that group also the name and uid of the owner of that group.</li></ol><p>Another IDOR and again I was rewarded $$$ for this bug.</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fgiphy.com%2Fembed%2FMhHXeM4SpKrpC%2Ftwitter%2Fiframe&amp;display_name=Giphy&amp;url=https%3A%2F%2Fgiphy.com%2Fgifs%2Fpokemon-celebration-hooray-MhHXeM4SpKrpC&amp;image=https%3A%2F%2Fmedia2.giphy.com%2Fmedia%2FMhHXeM4SpKrpC%2Fgiphy.gif&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=giphy" width="435" height="243" frameborder="0" scrolling="no"><a href="https://medium.com/media/6a84d842f5acdec1f37738600264914e/href">https://medium.com/media/6a84d842f5acdec1f37738600264914e/href</a></iframe><p>#<strong>Blogs /Writeups :</strong></p><ul><li><a href="https://www.bugcrowd.com/blog/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/">How-To: Find IDOR (Insecure Direct Object Reference) Vulnerabilities for Large Bounty Rewards | @Bugcrowd</a></li><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Direct%20Object%20References">swisskyrepo/PayloadsAllTheThings</a></li><li><a href="https://blog.intigriti.com/hackademy/idor/">Insecure Direct Object Reference (IDOR) - Intigriti</a></li><li><a href="https://medium.com/@pratyush1337/idor-bugs-are-pure-love-7k-250-54f3235ee943">IDOR Bugs are Pure Love($7k+$250)</a></li><li><a href="https://ninadmathpati.com/2019/05/16/how-critical-is-idor-vulnerability-can-it-take-down-a-whole-company/">How critical is IDOR vulnerability? Can it take down a whole company? ~ Ninad Mathpati</a></li><li><a href="https://blog.usejournal.com/a-less-known-attack-vector-second-order-idor-attacks-14468009781a">A Less Known Attack Vector, Second Order IDOR Attacks</a></li><li><a href="https://medium.com/@aysebilgegunduz/everything-you-need-to-know-about-idor-insecure-direct-object-references-375f83e03a87">Everything You Need to Know About IDOR (Insecure Direct Object References)</a></li><li><a href="https://pentester.land/list-of-bug-bounty-writeups.html">List of bug bounty writeups</a></li><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html">Insecure Direct Object Reference Prevention - OWASP Cheat Sheet Series</a></li><li><a href="https://medium.com/@vickieli/how-to-find-more-idors-ae2db67c9489">How to find more IDORs</a></li></ul><p>#<strong>Mindmap </strong>:</p><p><a href="https://www.mindmeister.com/1470766611/web-app-pentest">Web App Pentest</a></p><p>#<strong>Burp Extensions </strong>:</p><ul><li><a href="https://portswigger.net/bappstore/f9bbac8c4acf4aefa4d7dc92a991af2f">Autorize</a></li><li><a href="https://portswigger.net/bappstore/f89f2837c22c4ab4b772f31522647ed8">AutoRepeater</a></li></ul><p>There is a video by <a href="https://www.youtube.com/channel/UCQN2DsjnYH60SFBIA6IkNwg">STÖK,</a> which explains very well about how to use Autorize and Auto Repeater :</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F3K1-a7dnA60%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D3K1-a7dnA60&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F3K1-a7dnA60%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="854" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/12821f47199bf52aac3ea925447af0dd/href">https://medium.com/media/12821f47199bf52aac3ea925447af0dd/href</a></iframe><p>Special Thanks to <a href="https://twitter.com/nightwatch1337">Pratyush Anjan Sarangi</a> and <a href="https://twitter.com/ninad_mathpati">Ninad Mathpati</a> for helping and guiding me.</p><p>As this is my first writeup, sorry if there is any mistake :D</p><p>Connect with me :</p><p>Linkedin : <a href="https://in.linkedin.com/in/m0hn1sh">https://in.linkedin.com/in/m0hn1sh</a></p><p>Twitter : <a href="https://twitter.com/M0hn1sh">https://twitter.com/M0hn1sh</a></p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=849db2828c8" width="1" height="1" alt=""><hr><p><a href="https://infosecwriteups.com/all-about-getting-first-bounty-with-idor-849db2828c8">All About Getting First Bounty with IDOR</a> was originally published in <a href="https://infosecwriteups.com">InfoSec Write-ups</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
